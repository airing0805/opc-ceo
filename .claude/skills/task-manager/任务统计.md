# 任务统计

## 功能概述

提供任务的统计分析功能，包括日报、周报、完成率分析、时间追踪等。

## 操作命令

### 命令 1：生成日报

**用途**：生成当日任务执行情况的日报

**语法**：
```
生成日报:
  - date: <日期> (可选，默认今天)
  - includeCancelled: <是否包含已取消> (可选，默认false)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| date | string | 否 | 报告日期，格式YYYY-MM-DD，默认今天 |
| includeCancelled | boolean | 否 | 是否包含已取消任务，默认false |

**报告内容**：
- 当日创建的任务数
- 当日完成的任务数
- 进行中的任务数
- 按优先级分布
- 完成率

**示例**：
```
生成日报:
  - date: 2026-02-23
```

---

### 命令 2：生成周报

**用途**：生成本周任务执行情况的周报

**语法**：
```
生成周报:
  - startDate: <开始日期> (可选，默认本周一)
  - endDate: <结束日期> (可选，默认本周日)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| startDate | string | 否 | 周报开始日期，默认本周一 |
| endDate | string | 否 | 周报结束日期，默认本周日 |

**报告内容**：
- 本周完成任务总数
- 本周创建任务总数
- 按日期分布
- 按优先级分布
- 平均完成时间
- 周完成率

**示例**：
```
生成周报:
  - startDate: 2026-02-17
  - endDate: 2026-02-23
```

---

### 命令 3：按项目统计

**用途**：按项目分组统计任务情况

**语法**：
```
按项目统计:
  - projectId: <项目ID> (可选，不指定则统计所有项目)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| projectId | string | 否 | 项目ID，不指定则统计所有项目 |

**报告内容**：
- 项目总任务数
- 已完成/进行中/待处理/阻塞/取消的任务数
- 项目完成率
- 平均任务耗时

**示例**：
```
按项目统计:
  - projectId: PROJ-001
```

---

### 命令 4：完成率分析

**用途**：分析任务完成率趋势

**语法**：
```
完成率分析:
  - period: <周期> (可选，默认week)
  - count: <周期数> (可选，默认4)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| period | string | 否 | 统计周期：day/week/month，默认week |
| count | number | 否 | 周期数量，默认4 |

**报告内容**：
- 每周期的完成率
- 完成率趋势
- 平均完成率

**示例**：
```
完成率分析:
  - period: week
  - count: 4
```

---

### 命令 5：时间追踪统计

**用途**：统计任务时间使用情况

**语法**：
```
时间追踪统计:
  - startDate: <开始日期> (可选)
  - endDate: <结束日期> (可选)
  - groupBy: <分组方式> (可选，默认date)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| startDate | string | 否 | 开始日期，默认30天前 |
| endDate | string | 否 | 结束日期，默认今天 |
| groupBy | string | 否 | 分组方式：date/project/priority，默认date |

**报告内容**：
- 总任务时间
- 平均任务时间
- 按分组的时间分布
- 估算时间 vs 实际时间对比

**示例**：
```
时间追踪统计:
  - startDate: 2026-02-01
  - endDate: 2026-02-23
  - groupBy: project
```

---

### 命令 6：逾期任务报告

**用途**：列出已逾期和即将逾期的任务

**语法**：
```
逾期任务报告:
  - days: <天数范围> (可选，默认7)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| days | number | 否 | 查询天数，默认7天 |

**报告内容**：
- 已逾期任务列表
- 即将逾期任务列表（7天内）
- 按优先级排序

**示例**：
```
逾期任务报告:
  - days: 7
```

---

## MCP Memory 使用

### 统计查询

```
使用 mcp__memory__search_nodes 查询任务:
{
  "query": "Task status:completed createdAt:2026-02-23"
}
```

### 时间统计

```
查询已完成任务的 actualMinutes 属性进行汇总计算
```

---

## 报告格式

### 日报格式

```markdown
## 日报 - 2026-02-23

### 概览
- 创建任务: 5 个
- 完成任务: 3 个
- 进行中: 2 个
- **完成率: 60%**

### 按优先级
- Critical: 0 个
- High: 2 个 (1 完成, 1 进行中)
- Medium: 3 个 (2 完成, 1 进行中)
- Low: 0 个

### 今日完成任务
1. TASK-2026-02-23-001: 完成项目文档 (90分钟)
2. ...
```

### 周报格式

```markdown
## 周报 - 2026-02-17 至 2026-02-23

### 概览
- 创建任务: 28 个
- 完成任务: 22 个
- **周完成率: 78.6%**
- 平均完成时间: 65 分钟

### 按日期分布
| 日期 | 创建 | 完成 | 完成率 |
|------|------|------|--------|
| 02-17 (一) | 4 | 3 | 75% |
| 02-18 (二) | 5 | 4 | 80% |
| ...
```

---

## 统计指标

| 指标 | 计算方式 |
|------|---------|
| 完成率 | 已完成任务 / 非取消任务总数 |
| 平均完成时间 | sum(actualMinutes) / count(completed) |
| 时间准确率 | sum(estimatedMinutes) / sum(actualMinutes) |
| 逾期率 | 逾期任务 / 总任务数 |

---

## 相关模块

- [任务操作](任务操作.md) - 基础CRUD操作
- [任务流转](任务流转.md) - 状态转换
