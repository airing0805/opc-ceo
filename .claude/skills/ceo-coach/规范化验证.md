# 规范化验证

> Coach 每 12 小时自动执行的规范化验证系统
> 确保所有规范得到遵守、规范内容完整无遗漏、规范之间无冲突

---

## 概述

Coach 每 **12 小时**（每半天）自动执行一次完整的规范化验证。

### 规范化验证触发

| 触发方式 | 频率 | 说明 |
|----------|------|------|
| 自动 | 每 12 小时 | 集成到 24h 进化系统中 |
| 手动 | 重要操作后 | 执行规范化任务后自动触发 |
| 请求 | 用户要求 | 用户可请求立即验证 |

---

## 验证项目清单

### A. 规范执行验证（验证规范是否被遵守）

**1. 任务ID格式规范化**

| 检查项 | 工具 | 验证标准 |
|--------|------|----------|
| TASK- 残留检查 | Grep | 任务分配.md 中不应有 TASK- 开头 |
| v2.x.y 格式 | Grep | 任务ID应为 v2.x.y 格式 |
| ID 唯一性 | 逻辑检查 | 不应有重复的任务ID |

**2. 文档格式规范化**

| 检查项 | 工具 | 验证标准 |
|--------|------|----------|
| 表格结构 | Read | 任务表格应有正确的列对齐 |
| 状态标记 | Grep | 使用 `[ ]` / `[x]` / ✅ 等标准符号 |
| 中文命名 | 观察 | 文档使用中文命名 |

**3. 实体ID命名规范**

| 检查项 | 验证标准 |
|--------|----------|
| 任务 | v2.x.y 格式 |
| 协调事件 | COORD-YYYY-MM-DD-NNN 格式 |
| 对话记录 | CONV-YYYY-MM-DD-NNN 格式 |
| 进化决策 | EVO-YYYY-MM-DD-NNN 格式 |

**4. 文件命名规范**

| 检查项 | 工具 | 验证标准 |
|--------|------|----------|
| 文档命名 | Glob | docs/ 下使用中文命名 |
| Skill 模块 | Glob | .claude/skills/ 下中文命名 |

---

### B. 规范完整性验证（验证规范内容无遗漏）

**验证方法**：对照 `docs/沟通文档/文档沟通规范.md` 检查

| 检查项 | 说明 |
|--------|------|
| 目录结构 | 确认 docs/沟通文档/ 下包含所有必需文档 |
| 文档模板 | 确认各文档类型有正确模板 |
| 状态标记 | 确认所有状态标记符号有定义 |
| 命名规范 | 确认文件命名和实体ID命名规则完整 |
| 沟通流程 | 确认用户确认机制、任务分配流程等完整 |
| 验收标准 | 确认所有验收检查项已定义 |

---

### C. 规范冲突验证（验证规范之间无矛盾）

**冲突检测规则**：

| 冲突类型 | 检测方法 | 处理 |
|----------|----------|------|
| 命名冲突 | 对比不同文档中的ID格式定义 | 以最新文档为准，更新旧文档 |
| 状态冲突 | 检查同一任务的状态标记是否一致 | 修复不一致项 |
| 格式冲突 | 对比任务分配.md与规范模板 | 修复格式偏差 |
| 层级冲突 | 检查版本号层级是否一致 | 统一层级定义 |

**冲突检测流程**：
```
【1. 收集规范】→【2. 对比分析】→【3. 冲突识别】→【4. 冲突解决】→【5. 记录变更】
```

---

## 验证执行流程

```
【A. 规范执行验证】→【B. 规范完整性验证】→【C. 规范冲突验证】→【D. 生成验证报告】

详细：
【1. 任务ID检查】→【2. 文档格式检查】→【3. 实体ID检查】→【4. 文件命名检查】
→【5. 规范完整性检查】→【6. 规范冲突检测】→【7. 生成验证报告】
```

---

## 验证报告格式

```markdown
# 规范化验证报告

**验证时间**: <时间>
**验证状态**: ✅ 通过 / ⚠️ 异常

## A. 规范执行验证

| 检查项 | 状态 | 异常数量 | 说明 |
|--------|------|----------|------|
| 任务ID格式 | ✅ | 0 | - |
| 文档格式 | ⚠️ | 1 | 任务分配.md 第748行格式错误 |
| 实体ID | ✅ | 0 | - |
| 文件命名 | ✅ | 0 | - |

## B. 规范完整性验证

| 规范项 | 状态 | 说明 |
|--------|------|------|
| 目录结构 | ✅ | 完整 |
| 文档模板 | ✅ | 完整 |
| 状态标记 | ✅ | 完整 |
| 命名规范 | ✅ | 完整 |
| 沟通流程 | ✅ | 完整 |
| 验收标准 | ✅ | 完整 |

## C. 规范冲突验证

| 冲突项 | 状态 | 说明 |
|--------|------|------|
| 命名冲突 | ✅ | 无冲突 |
| 状态冲突 | ✅ | 无冲突 |
| 格式冲突 | ✅ | 无冲突 |
| 层级冲突 | ✅ | 无冲突 |

## 异常详情

### 异常 1: 任务分配.md
- 位置: 第748行
- 问题: 格式错误的任务项
- 处理: 已修复

## 下次验证时间: <时间>
```

---

## 异常处理

| 异常级别 | 处理方式 |
|----------|----------|
| 高 | 立即修复，记录到验证报告 |
| 中 | 生成修复任务，加入待办 |
| 低 | 记录到观察清单，下次关注 |

---

## 规范冲突处理原则

1. **时间优先**：后定义的规范优先于先定义的
2. **覆盖原则**：主规范覆盖子规范
3. **明确优先**：有明确示例的规范优先
4. **文档记录**：冲突解决必须记录到变更历史

---

## 相关文档

- `docs/沟通文档/规范清单.md` - 完整规范清单
- `docs/沟通文档/文档沟通规范.md` - 核心规范文档
