# 第三章：实战案例

> 本章是全书的精华所在。我们将通过 4 个精心设计的实战案例，带你深入体验 MCP 的强大功能。每个案例都包含完整的配置步骤、使用示例和效果展示，让你能够即学即用。

---

## 3.1 案例一：使用 Filesystem MCP 管理本地文件

### 3.1.1 场景描述

作为一名内容创作者或开发者，你可能经常需要：
- 让 AI 帮你整理本地文档
- 批量重命名或移动文件
- 在多个文件中搜索特定内容
- 让 AI 阅读你的项目代码并给出建议

传统的做法是手动操作，或者在终端中输入繁琐的命令。现在，通过 Filesystem MCP，你可以直接用自然语言让 AI 帮你完成这些任务。

**本案例目标**：配置 Filesystem MCP，实现通过 Claude 管理本地文档文件夹。

### 3.1.2 配置步骤

**第一步：创建工作目录**

首先，创建一个专门用于 AI 管理的文件夹：

```bash
# macOS / Linux
mkdir -p ~/Documents/ai-workspace

# Windows (PowerShell)
New-Item -ItemType Directory -Path "$env:USERPROFILE\Documents\ai-workspace"
```

**第二步：编辑配置文件**

打开 Claude Desktop 配置文件：
- **macOS**：`~/Library/Application Support/Claude/claude_desktop_config.json`
- **Windows**：`%APPDATA%/Claude/claude_desktop_config.json`

添加 Filesystem MCP 服务器配置：

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/Users/yourname/Documents/ai-workspace"
      ]
    }
  }
}
```

> **注意**：请将路径替换为你实际创建的目录路径。Windows 用户使用正斜杠或双反斜杠，如 `C:/Users/yourname/Documents/ai-workspace`。

**第三步：重启 Claude Desktop**

配置完成后，完全关闭 Claude Desktop（确保进程已结束），然后重新启动。

**第四步：验证配置**

在 Claude Desktop 中，点击右下角的工具图标（或查看设置），确认 `filesystem` 服务器已连接。你应该能看到一系列可用的工具，如 `read_file`、`write_file`、`list_directory` 等。

### 3.1.3 实际使用示例

**示例 1：列出目录内容**

```
用户：请列出我的 ai-workspace 文件夹里有什么文件。

Claude：我来查看一下你的 ai-workspace 目录。
[调用 list_directory 工具]

你的 ai-workspace 文件夹目前包含：
- 项目笔记.md
- 会议记录/
- 待办事项.txt
```

**示例 2：搜索文件**

```
用户：帮我在文件夹里搜索所有包含"会议"的文件。

Claude：[调用 search_files 工具]
找到了 2 个相关文件：
1. 会议记录/2024-01-产品会议.md
2. 会议记录/2024-02-技术评审.md
```

**示例 3：读取和总结文件**

```
用户：请阅读"项目笔记.md"，给我一个要点总结。

Claude：[调用 read_file 工具]

根据你的项目笔记，主要内容包括：
1. 项目目标：开发一个 MCP 实战教程
2. 当前进度：已完成第一章和第二章
3. 待办事项：第三章需要 4 个案例
4. 截止日期：本月底
```

**示例 4：创建新文件**

```
用户：请创建一个新文件"周报-2024-03.md"，内容是本周的工作总结模板。

Claude：[调用 write_file 工具]

已创建文件 "周报-2024-03.md"，内容如下：
## 本周工作总结

### 完成事项
- [ ] 

### 进行中
- [ ] 

### 下周计划
- [ ] 

### 问题与思考
```

### 3.1.4 效果展示

通过 Filesystem MCP，你可以：

| 传统方式 | MCP 方式 |
|---------|---------|
| 打开 Finder/资源管理器，手动浏览文件 | 直接问"有哪些文件" |
| 用 grep 命令搜索内容 | 直接问"搜索包含xxx的文件" |
| 手动复制粘贴创建文件 | 直接说"创建一个xxx文件" |
| 逐个打开文件阅读 | 让 AI 读取并总结 |

**效率提升**：对于日常的文件管理任务，效率提升约 3-5 倍。

### 3.1.5 安全注意事项

Filesystem MCP 会授予 AI 访问你指定目录的权限，请注意：

1. **只暴露必要的目录**：不要将整个用户目录或系统目录暴露给 AI
2. **重要文件备份**：在让 AI 修改文件前，先做好备份
3. **审查操作**：Claude Desktop 会在执行写操作前请求确认，请仔细审查

---

## 3.2 案例二：使用 GitHub MCP 自动化代码管理

### 3.2.1 场景描述

如果你是一名开发者，GitHub MCP 可以让你的 AI 助手直接帮你：
- 查看 Issue 和 Pull Request
- 创建和管理 Issues
- 搜索代码仓库
- 创建分支和 PR（需要适当权限）

**本案例目标**：配置 GitHub MCP，实现通过 Claude 管理 GitHub 项目。

### 3.2.2 准备工作

**创建 GitHub Personal Access Token**

1. 登录 GitHub，点击右上角头像 → Settings
2. 左侧菜单最下方 → Developer settings
3. Personal access tokens → Tokens (classic)
4. 点击 "Generate new token (classic)"
5. 勾选以下权限：
   - `repo`（完整仓库访问）
   - `read:org`（读取组织信息）
   - `read:user`（读取用户信息）
6. 点击 "Generate token"
7. **立即复制并保存 Token**（只显示一次！）

### 3.2.3 配置步骤

编辑 Claude Desktop 配置文件，添加 GitHub MCP：

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/Users/yourname/Documents/ai-workspace"
      ]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "ghp_xxxxxxxxxxxxxxxxxxxx"
      }
    }
  }
}
```

> **安全提示**：不要将包含真实 Token 的配置文件提交到版本控制系统中。

重启 Claude Desktop 后，GitHub MCP 就可用了。

### 3.2.4 实际使用示例

**示例 1：搜索仓库**

```
用户：帮我搜索一下与 "MCP server" 相关的热门仓库。

Claude：[调用 search_repositories 工具]

找到了以下热门仓库：

1. modelcontextprotocol/servers (⭐ 2.3k)
   - 官方 MCP 服务器集合
   
2. modelcontextprotocol/python-sdk (⭐ 1.2k)
   - Python SDK for MCP
   
3. anthropics/mcp-ts (⭐ 890)
   - TypeScript implementation
```

**示例 2：查看仓库 Issue**

```
用户：查看 modelcontextprotocol/servers 仓库最近有哪些 Issue。

Claude：[调用 list_issues 工具]

最近的 Issues：

#156 - Filesystem server fails on Windows paths
   - 状态：Open
   - 创建时间：2 hours ago
   
#155 - Add support for SFTP protocol
   - 状态：Open  
   - 创建时间：1 day ago
   
#154 - Memory leak in long-running sessions
   - 状态：Closed (fixed)
   - 创建时间：2 days ago
```

**示例 3：创建 Issue**

```
用户：帮我在我的仓库 myproject/demo 里创建一个 Issue，标题是"添加用户登录功能"，内容描述一下实现思路。

Claude：[调用 create_issue 工具]

已在 myproject/demo 仓库创建 Issue #23：

标题：添加用户登录功能

内容：
## 功能描述
实现用户登录功能，支持以下方式：
- 邮箱密码登录
- 第三方 OAuth 登录（Google、GitHub）

## 技术方案
1. 使用 JWT 进行身份验证
2. 密码使用 bcrypt 加密存储
3. 实现登录状态持久化

## 验收标准
- [ ] 用户可以通过邮箱密码登录
- [ ] 登录状态保持 7 天
- [ ] 登录失败有友好提示
```

**示例 4：获取文件内容**

```
用户：帮我看看 modelcontextprotocol/servers 仓库的 README 文件。

Claude：[调用 get_file_contents 工具]

这是该仓库的 README 主要内容：

# MCP Servers

官方 MCP 服务器集合，包含：
- server-filesystem：文件系统操作
- server-github：GitHub 集成
- server-postgres：PostgreSQL 数据库
- server-slack：Slack 消息
...

安装方式：
npx -y @modelcontextprotocol/server-filesystem /path/to/dir
```

### 3.2.5 效果展示

通过 GitHub MCP，你可以：

| 任务 | 传统方式 | MCP 方式 |
|------|---------|---------|
| 查看 Issue | 打开 GitHub 网页浏览 | 直接问"最近有什么 Issue" |
| 创建 Issue | 网页填写表单 | 描述需求，AI 生成内容 |
| 搜索代码 | 使用 GitHub 搜索框 | 自然语言描述搜索意图 |
| 查看 PR | 逐个打开查看 | 让 AI 总结 PR 内容 |

**实际收益**：减少在 GitHub 网页和终端之间的切换，提高开发效率。

---

## 3.3 案例三：使用 Slack MCP 实现消息通知

### 3.3.1 场景描述

想象这样一个工作流：
1. 你用 Claude 分析了一份报告
2. 分析完成后，自动发送摘要到团队 Slack 频道
3. 重要事件触发时，AI 自动发消息提醒你

通过 Slack MCP，这些都可以实现。

**本案例目标**：配置 Slack MCP，实现 AI 助手发送 Slack 消息。

### 3.3.2 准备工作

**创建 Slack App**

1. 访问 [Slack API](https://api.slack.com/apps)
2. 点击 "Create New App"
3. 选择 "From scratch"
4. 输入 App 名称（如 "MCP Assistant"）并选择工作区
5. 在左侧菜单选择 "OAuth & Permissions"
6. 添加以下 Bot Token Scopes：
   - `chat:write` - 发送消息
   - `channels:read` - 读取频道列表
   - `channels:history` - 读取频道历史
   - `groups:read` - 读取私有频道
   - `im:read` - 读取私信
   - `im:history` - 读取私信历史
7. 点击 "Install to Workspace"
8. 复制生成的 "Bot User OAuth Token"（以 `xoxb-` 开头）

**邀请 Bot 到频道**

在你的 Slack 频道中，输入：
```
/invite @MCP Assistant
```

### 3.3.3 配置步骤

```json
{
  "mcpServers": {
    "slack": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-slack"],
      "env": {
        "SLACK_BOT_TOKEN": "xoxb-xxxxxxxxxxxxxxxxxxxxxxxx"
      }
    }
  }
}
```

重启 Claude Desktop 即可使用。

### 3.3.4 实际使用示例

**示例 1：发送消息到频道**

```
用户：帮我在 #general 频道发一条消息，告诉大家今天下午 3 点有团队会议。

Claude：[调用 slack_postMessage 工具]

消息已发送到 #general 频道：
📢 团队会议提醒

今天下午 3 点有团队会议，请各位准时参加。

会议地点：3 号会议室 / 线上会议链接
```

**示例 2：读取频道消息**

```
用户：帮我看看 #project-alpha 频道最近有什么重要消息。

Claude：[调用 slack_getChannelHistory 工具]

#project-alpha 频道最近的消息：

1. @张三: "API v2 已经部署到测试环境，大家可以开始测试了"
   - 10:30 AM

2. @李四: "发现一个 bug，已创建 Issue #456"
   - 11:15 AM

3. @王五: "今天的部署推迟到明天上午"
   - 2:00 PM
```

**示例 3：工作流集成示例**

```
用户：我刚刚完成了一份周报，帮我总结要点然后发到 #weekly-reports 频道。

Claude：我来读取你的周报文件并总结。

[调用 read_file 读取周报]
[调用 slack_postMessage 发送消息]

已将周报总结发送到 #weekly-reports：

📋 本周工作总结 - Week 12

完成事项：
- 完成 MCP 电子书第三章初稿
- 修复 3 个用户反馈的 bug
- 优化系统性能，响应时间减少 40%

下周计划：
- 完成电子书第四章
- 开始新功能开发
```

### 3.3.5 效果展示

Slack MCP 的典型应用场景：

| 场景 | 说明 |
|------|------|
| 任务完成通知 | AI 完成长时间任务后自动通知 |
| 报告自动推送 | 分析报告完成后自动发到团队频道 |
| 提醒助手 | 结合日程，自动发送提醒消息 |
| 信息同步 | 读取 Slack 消息，汇总重要信息 |

---

## 3.4 案例四：组合多个 MCP 服务器实现复杂工作流

### 3.4.1 场景描述

MCP 的真正威力在于组合使用多个服务器。让我们来看一个综合案例：

**场景**：作为一名技术内容创作者，你需要：
1. 在 GitHub 上管理你的开源项目
2. 在本地编写和存储文档
3. 发布内容到 Slack 频道通知订阅者

通过组合 Filesystem、GitHub 和 Slack 三个 MCP，Claude 可以帮你完成整个工作流。

### 3.4.2 配置多个 MCP 服务器

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/Users/yourname/Documents/content-projects"
      ]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "ghp_xxxxxxxxxxxxxxxxxxxx"
      }
    },
    "slack": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-slack"],
      "env": {
        "SLACK_BOT_TOKEN": "xoxb-xxxxxxxxxxxxxxxxxxxxxxxx"
      }
    }
  }
}
```

### 3.4.3 综合工作流示例

**示例：发布一篇技术文章**

```
用户：帮我完成以下任务：
1. 在本地创建一篇新文章 "MCP 高级技巧.md"
2. 把文章提交到我的 GitHub 仓库 myblog/posts
3. 发送发布通知到 Slack #content-updates 频道

文章主题是 MCP 的高级使用技巧，包括错误处理、性能优化和最佳实践。

Claude：好的，我来帮你完成这个工作流。

第一步：创建本地文章
[调用 write_file 工具]
✅ 已创建文件 "MCP 高级技巧.md"

第二步：上传到 GitHub
[调用 create_or_update_file 工具]
✅ 已提交到 myblog/posts 仓库

第三步：发送 Slack 通知
[调用 slack_postMessage 工具]
✅ 已发送发布通知到 #content-updates

工作流完成！以下是详细信息：

📄 文章信息：
- 标题：MCP 高级技巧
- 文件：MCP 高级技巧.md
- 字数：约 1500 字

📦 GitHub 提交：
- 仓库：myblog/posts
- Commit: "feat: 添加 MCP 高级技巧文章"

📢 Slack 通知：
- 频道：#content-updates  
- 内容：新文章发布提醒 + 文章摘要
```

### 3.4.4 自动化场景举例

**场景 1：每日项目状态汇总**

```
用户：帮我生成今天的项目状态报告，包括：
- 我的 GitHub 仓库今天的 commit 情况
- 本地工作文件夹的新增文件
- 发送汇总到 Slack #daily-standup

Claude：[执行多步骤工作流]
✅ 已生成并发送今日状态报告
```

**场景 2：Issue 响应自动化**

```
用户：检查我的仓库有没有新的 bug Issue，如果有，创建一个本地笔记记录详情。

Claude：[检查 GitHub Issues]
[创建本地笔记文件]
✅ 发现 2 个新 bug Issue，已创建笔记文件
```

### 3.4.5 工作流设计原则

设计多 MCP 工作流时，遵循以下原则：

1. **单一职责**：每个 MCP 负责一个领域
   - Filesystem：本地文件操作
   - GitHub：代码仓库管理
   - Slack：消息通知

2. **顺序合理**：按依赖关系排列操作顺序
   ```
   创建内容 → 存储到本地 → 上传到远程 → 发送通知
   ```

3. **错误处理**：在每一步确认成功后再继续
   - 文件创建失败 → 不上传
   - 上传失败 → 不发通知

4. **幂等性**：重复执行不会产生副作用
   - 使用唯一文件名
   - 检查是否已存在

### 3.4.6 效果展示

| 传统工作流 | MCP 自动化工作流 |
|-----------|-----------------|
| 手动写文章 → 手动 git push → 手动发 Slack | 一句话完成全流程 |
| 30+ 分钟操作时间 | 1 分钟内完成 |
| 容易遗漏步骤 | AI 确保每步完成 |
| 需要在多个工具间切换 | 统一在 Claude 中完成 |

**效率提升**：对于需要跨多个工具的复杂工作流，效率提升可达 10 倍以上。

---

## 3.5 本章小结

本章通过 4 个实战案例，我们学习了：

### 案例回顾

| 案例 | MCP 服务器 | 核心能力 | 典型场景 |
|------|-----------|---------|---------|
| 文件管理 | filesystem | 读写、搜索本地文件 | 文档整理、代码阅读 |
| 代码管理 | github | 仓库操作、Issue/PR 管理 | 开发协作、项目管理 |
| 消息通知 | slack | 发送/读取消息 | 团队通知、自动化提醒 |
| 综合工作流 | 多个组合 | 跨工具自动化 | 内容发布、状态同步 |

### 关键收获

1. **配置是第一步**：每个 MCP 都需要正确的配置，包括命令、参数和环境变量
2. **Token 要保护好**：敏感凭证不要泄露，不要提交到代码仓库
3. **从简单开始**：先熟悉单个 MCP，再尝试组合使用
4. **安全意识**：只授予必要的权限，重要操作前确认

### 下一章预告

第四章将带你深入了解：
- MCP 协议的技术原理
- 如何开发自己的 MCP 服务器
- MCP 的最佳实践和常见问题

---

## 延伸阅读

- [MCP 官方服务器列表](https://github.com/modelcontextprotocol/servers)
- [GitHub MCP 文档](https://github.com/modelcontextprotocol/servers/tree/main/src/github)
- [Slack MCP 文档](https://github.com/modelcontextprotocol/servers/tree/main/src/slack)
- [Filesystem MCP 文档](https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem)
