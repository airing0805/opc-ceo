# 智能任务分发（V5.0 核心优化）

> 本模块从 SKILL.md 拆分，定义五级任务分发机制和动态复杂度评分。

---

## 五级分发机制

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     V5.0 五级任务分发机制                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   任务输入                                                                │
│      │                                                                   │
│      ▼                                                                   │
│   ┌─────────────────────────────────────────────────────────────────┐   │
│   │ 复杂度评分 (动态调整)                                             │   │
│   │ - 文件数 × 操作类型系数 × 依赖度 × 历史调整因子                    │   │
│   └──────────────────────────┬──────────────────────────────────────┘   │
│                              │                                           │
│   ┌──────────┬───────────────┼───────────────┬──────────┐              │
│   │          │               │               │          │              │
│   ▼          ▼               ▼               ▼          ▼              │
│ L1         L2              L3              L4         L5              │
│ < 2        2-4             4-6             6-8        > 8              │
│   │          │               │               │          │              │
│   ▼          ▼               ▼               ▼          ▼              │
│ 直接执行   MCP工具         Agent          Team        拆分+          │
│ 单文件     文档优先        专项执行       协调        递归            │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 分发规则表

| 级别 | 复杂度范围 | 执行方式 | 典型场景 |
|------|-----------|----------|----------|
| L1 | < 2 | 直接执行 | 单文件读取、简单查询 |
| L2 | 2-4 | **MCP 工具优先** | 文档创建/编辑/写入 |
| L3 | 4-6 | Agent 执行 | 跨文件操作、知识推理 |
| L4 | 6-8 | Team 协调 | 多角色任务、复杂流程 |
| L5 | > 8 | 拆分+递归 | 超复杂任务分解 |

---

## 动态复杂度评分

**优化后公式**：
```
复杂度 = 文件数 × 操作类型系数 × 依赖度 × 历史调整因子

历史调整因子 = f(历史执行数据)

调整规则：
1. 每10次执行后自动调整
2. 如果某类型任务平均超时 > 20%，提高该类型系数 10%
3. 如果某类型任务平均提前完成 > 30%，降低该类型系数 5%
4. 系数范围：0.5 ~ 3.0
```

---

## 基础系数表

| 操作类型 | 基础系数 | 动态范围 |
|----------|----------|----------|
| 读取 | 1.0 | 0.5 ~ 1.5 |
| 写入 | 1.5 | 0.75 ~ 2.25 |
| 修改 | 1.8 | 0.9 ~ 2.7 |
| 删除 | 2.0 | 1.0 ~ 3.0 |

---

> 返回：[SKILL.md](SKILL.md) | 相关模块：[MCP工具使用.md](MCP工具使用.md) | [并行任务识别.md](并行任务识别.md)
