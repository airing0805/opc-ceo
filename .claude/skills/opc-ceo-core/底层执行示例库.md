# 底层执行示例库

> CEO 详细操作示例（V10.0 新增）
>
> **核心内容**: [底层执行能力.md](底层执行能力.md)
> **快速参考**: [快速参考.md](快速参考.md)

---

## 一、文档操作详细示例

### 1.1 读取单个文档

```json
// 首选：MCP 工具
mcp__filesystem__read_file({
  "path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/任务分配.md"
})

// 备选：内置工具
Read({
  "file_path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/任务分配.md"
})
```

### 1.2 批量读取多个文档

```json
// 同时读取多个文件（并行）
mcp__filesystem__read_file({ "path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/任务分配.md" })
mcp__filesystem__read_file({ "path": "E:/workspaces_2026_python/OPC-CEO/docs/战略规划/战略目标.md" })
mcp__filesystem__read_file({ "path": "E:/workspaces_2026_python/OPC-CEO/docs/版本规划/v2-技能规划/README.md" })
```

### 1.3 写入新文档

```json
mcp__filesystem__write_file({
  "path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/协调记录.md",
  "content": "# 协调记录\n\n## COORD-2026-02-26-001\n\n**时间**: 2026-02-26\n**类型**: 任务分配协调\n**内容**: ...\n"
})
```

### 1.4 编辑文档（精确替换）

```json
// 替换任务状态
Edit({
  "file_path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/任务分配.md",
  "old_string": "| v2.3.1.1 | 待执行 |",
  "new_string": "| v2.3.1.1 | 已完成 |"
})

// 追加新任务
Edit({
  "file_path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/任务分配.md",
  "old_string": "<!-- 新任务在此添加 -->",
  "new_string": "| v2.4.1.1 | 新增能力模块 | 待执行 | opc-ceo-core | 2026-02-26 |\n\n<!-- 新任务在此添加 -->"
})
```

---

## 二、Memory 操作详细示例

### 2.1 创建任务实体

```json
mcp__memory__create_entities({
  "entities": [{
    "name": "TASK-v2.3.1.1",
    "entityType": "Task",
    "observations": [
      "description: 创建 CEO 底层执行能力.md",
      "status: in_progress",
      "assignedTo: opc-ceo-core",
      "priority: high",
      "createdAt: 2026-02-26T10:00:00",
      "dueDate: 2026-02-26"
    ]
  }]
})
```

### 2.2 创建决策记录

```json
mcp__memory__create_entities({
  "entities": [{
    "name": "DECISION-2026-02-26-001",
    "entityType": "Decision",
    "observations": [
      "context: CEO 能力增强",
      "decision: 创建底层执行能力.md 文档",
      "reason: V10.0 进化计划",
      "impact: 提升 CEO 独立执行能力",
      "timestamp: 2026-02-26T10:00:00"
    ]
  }]
})
```

### 2.3 创建执行日志

```json
mcp__memory__create_entities({
  "entities": [{
    "name": "LOG-2026-02-26-001",
    "entityType": "ExecutionLog",
    "observations": [
      "taskId: TASK-v2.3.1.1",
      "executionPath: L2-MCP工具优先",
      "complexityScore: 3",
      "result: 成功",
      "duration: 120秒",
      "decisionPoints: [\"使用MCP工具\", \"并行读取模板\"]",
      "lessons: \"模板参考提高效率\""
    ]
  }]
})
```

### 2.4 创建进化记录

```json
mcp__memory__create_entities({
  "entities": [{
    "name": "EVOLUTION-2026-02-26-001",
    "entityType": "Evolution",
    "observations": [
      "type: capability_improvement",
      "area: thinking_framework",
      "change: WRAP 框架强化 + 12项检查清单",
      "status: completed",
      "version: V10.0",
      "timestamp: 2026-02-26T10:30:00"
    ]
  }]
})
```

### 2.5 查询实体

```json
// 启动自检 - 检查 Memory 状态
mcp__memory__search_nodes({
  "query": "company status task project"
})

// 查找特定任务
mcp__memory__search_nodes({
  "query": "TASK-v2.3.1"
})

// 查找当天的决策记录
mcp__memory__search_nodes({
  "query": "DECISION-2026-02-26"
})

// 查找执行日志
mcp__memory__search_nodes({
  "query": "LOG-2026-02"
})

// 读取完整图谱
mcp__memory__read_graph({})
```

### 2.6 更新实体观察

```json
// 更新任务状态
mcp__memory__add_observations({
  "observations": [{
    "entityName": "TASK-v2.3.1.1",
    "contents": [
      "status: completed",
      "completedAt: 2026-02-26T11:00:00",
      "result: 成功创建底层执行能力.md"
    ]
  }]
})

// 为执行日志添加教训
mcp__memory__add_observations({
  "observations": [{
    "entityName": "LOG-2026-02-26-001",
    "contents": [
      "lesson: 模板参考可以显著提高文档创建效率",
      "improvement: 建立常用模板库"
    ]
  }]
})
```

### 2.7 创建关系

```json
// 创建任务与决策的关系
mcp__memory__create_relations({
  "relations": [{
    "from": "TASK-v2.3.1.1",
    "to": "DECISION-2026-02-26-001",
    "relationType": "triggered_by"
  }]
})

// 创建任务与日志的关系
mcp__memory__create_relations({
  "relations": [{
    "from": "TASK-v2.3.1.1",
    "to": "LOG-2026-02-26-001",
    "relationType": "results_in"
  }]
})

// 创建可并行任务关系
mcp__memory__create_relations({
  "relations": [{
    "from": "TASK-v2.3.1.1",
    "to": "TASK-v2.3.1.2",
    "relationType": "parallel_with"
  }]
})
```

---

## 三、完整操作流程示例

### 3.1 启动自检完整流程

```json
// 步骤1-4 可并行执行（无依赖）
mcp__memory__search_nodes({ "query": "company status task project" })
Bash({ "command": "git status" })
mcp__filesystem__read_file({
  "path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/任务分配.md"
})
mcp__filesystem__read_file({
  "path": "E:/workspaces_2026_python/OPC-CEO/docs/战略规划/战略目标.md"
})
```

### 3.2 Memory 重建完整流程

**触发条件**: Memory 返回空或异常

```
步骤1: 检测 Memory 状态
  工具: mcp__memory__search_nodes
  参数: { query: "task status" }
  判断: 若返回空，触发重建

步骤2: 读取任务分配文档
  工具: mcp__filesystem__read_file
  路径: docs/沟通文档/任务分配.md
  目的: 获取任务列表

步骤3: 重建 Task 实体
  工具: mcp__memory__create_entities
  内容: 为每个任务创建实体

步骤4: 读取战略目标文档
  工具: mcp__filesystem__read_file
  路径: docs/战略规划/战略目标.md
  目的: 获取目标列表

步骤5: 重建 Goal 实体
  工具: mcp__memory__create_entities
  内容: 为每个目标创建实体

步骤6: 验证重建结果
  工具: mcp__memory__search_nodes
  参数: { query: "task goal" }
  判断: 确认实体已创建
```

### 3.3 任务记录完整流程

**触发条件**: 与用户沟通确认任务后

```
步骤1: 创建 Memory 实体
  工具: mcp__memory__create_entities
  内容: 创建 Task 实体

步骤2: 更新任务分配文档
  工具: mcp__filesystem__read_file + Edit
  内容: 追加新任务记录

步骤3: 记录决策（如有）
  工具: mcp__memory__create_entities
  内容: 创建 Decision 实体

步骤4: 创建关系
  工具: mcp__memory__create_relations
  内容: 关联任务与决策
```

### 3.4 进化记录完整流程

**触发条件**: 自我进化执行完成后

```json
// 步骤1: 创建进化记录实体
mcp__memory__create_entities({
  "entities": [{
    "name": "EVOLUTION-2026-02-26-001",
    "entityType": "Evolution",
    "observations": [
      "type: capability_improvement",
      "area: execution_capability",
      "change: 底层执行能力.md 精简 + 示例库创建",
      "status: completed",
      "version: V10.0",
      "timestamp: 2026-02-26T11:00:00"
    ]
  }]
})

// 步骤2: 记录到文档
mcp__filesystem__write_file({
  "path": "E:/workspaces_2026_python/OPC-CEO/docs/沟通文档/自我进化/ceo 自我进化报告.md",
  "content": "..."
})

// 步骤3: 更新 Skill 文件版本
// （通过 Edit 工具）
```

### 3.5 风险预警检测流程

```
检测时机: 每次任务执行前/后

检测项:
├── 任务延期风险
│   ├── 信号: 执行时间 > 预估时间 × 0.8
│   └── 处理: 记录预警，重新评估资源
│
├── 角色疲劳风险
│   ├── 信号: 某角色连续失败 ≥ 3 次
│   └── 处理: 检查能力边界，考虑任务拆分
│
├── 上下文丢失风险
│   ├── 信号: 会话间隔 > 1 小时
│   └── 处理: 预加载上下文
│
├── 依赖断裂风险
│   ├── 信号: 依赖任务未完成
│   └── 处理: 调整执行顺序
│
└── 决策疲劳风险
    ├── 信号: 连续决策失败 ≥ 2 次
    └── 处理: 触发决策复盘
```

---

## 四、错误处理详细流程

### 4.1 MCP 工具不可用

```
MCP 工具调用失败
    │
    ├── 识别错误类型
    │   ├── File not found → 检查路径
    │   ├── Permission denied → 通知用户
    │   └── Tool error → 尝试备选工具
    │
    ├── 尝试备选工具
    │   ├── mcp__filesystem__read_file → Read
    │   ├── mcp__filesystem__write_file → Write
    │   ├── mcp__filesystem__edit_file → Edit
    │   ├── mcp__filesystem__search_files → Glob
    │   └── mcp__filesystem__list_directory → Bash ls
    │
    ├── 备选工具成功 → 继续执行
    │
    └── 备选工具失败
        ├── 记录错误详情
        ├── 通知用户
        └── 记录到执行日志
```

### 4.2 Memory 返回空

```
Memory 查询返回空
    │
    ├── 确认查询关键词正确
    │
    ├── 尝试使用 read_graph 查看完整图谱
    │
    ├── 确认 Memory 确实为空
    │
    ├── 触发 Memory 重建流程
    │   ├── 从文档读取数据
    │   ├── 创建 Memory 实体
    │   └── 创建关系
    │
    └── 验证重建结果
```

### 4.3 文档写入失败

```
文档写入失败
    │
    ├── 检查路径是否存在
    │   └── 目录不存在 → 先创建目录
    │
    ├── 检查文件权限
    │   └── 权限不足 → 通知用户
    │
    ├── 尝试备选工具
    │   ├── mcp__filesystem__write_file → Write
    │   └── Write → Bash echo
    │
    └── 记录失败原因
```

### 4.4 实体已存在错误

```
创建实体时返回"已存在"
    │
    ├── 使用 search_nodes 确认实体存在
    │
    ├── 使用 add_observations 更新
    │   └── mcp__memory__add_observations({
    │         "observations": [{
    │           "entityName": "已存在的实体名",
    │           "contents": ["新的观察记录"]
    │         }]
    │       })
    │
    └── 避免重复创建
```

---

## 五、搜索操作详细示例

### 5.1 搜索文件名

```json
// 按模式搜索文件
Glob({
  "pattern": "**/*.md",
  "path": "E:/workspaces_2026_python/OPC-CEO/docs"
})

// 搜索特定前缀的文件
Glob({
  "pattern": "TASK-*.md",
  "path": "E:/workspaces_2026_python/OPC-CEO"
})
```

### 5.2 搜索文件内容

```json
// 搜索关键词
Grep({
  "pattern": "任务",
  "path": "E:/workspaces_2026_python/OPC-CEO/docs",
  "output_mode": "content"
})

// 搜索并显示行号
Grep({
  "pattern": "WRAP",
  "path": "E:/workspaces_2026_python/OPC-CEO/.claude/skills/opc-ceo-core",
  "output_mode": "content",
  "-n": true
})

// 只返回匹配的文件路径
Grep({
  "pattern": "自我进化",
  "path": "E:/workspaces_2026_python/OPC-CEO/docs",
  "output_mode": "files_with_matches"
})

// 统计匹配数量
Grep({
  "pattern": "CEO",
  "path": "E:/workspaces_2026_python/OPC-CEO/docs",
  "output_mode": "count"
})
```

---

## 六、Git 操作详细示例

### 6.1 状态查看

```json
// 查看状态
Bash({ "command": "git status" })

// 查看差异
Bash({ "command": "git diff" })

// 查看日志（最近10条）
Bash({ "command": "git log --oneline -10" })

// 查看当前分支
Bash({ "command": "git branch" })

// 查看远程仓库
Bash({ "command": "git remote -v" })
```

### 6.2 提交流程

```json
// 步骤1: 查看状态
Bash({ "command": "git status" })

// 步骤2: 添加文件
Bash({ "command": "git add 文件路径" })

// 步骤3: 提交
Bash({ "command": "git commit -m \"feat: 提交信息\"" })

// 步骤4: 查看提交结果
Bash({ "command": "git log --oneline -1" })
```

### 6.3 Git 提交规范

| 类型 | 说明 | 示例 |
|------|------|------|
| feat | 新功能 | feat: 新增底层执行能力模块 |
| fix | 修复 | fix: 修复任务分发逻辑 |
| docs | 文档 | docs: 更新 SKILL.md |
| refactor | 重构 | refactor: 优化决策树 |
| chore | 杂项 | chore: 更新版本号 |

---

## 版本历史

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| **10.0.0** | **2026-02-26** | **从底层执行能力.md 分离，独立存放详细示例** |

---

> opc-ceo-core V10.0 - 底层执行示例库
