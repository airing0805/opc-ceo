# Git 推送规范

## 概述

本文档定义了 OPC-CEO 项目的 Git 提交和推送规范，确保代码同步的规律性和可追溯性。

## 推送频率

| 场景 | 频率 | 说明 |
|------|------|------|
| 日常开发 | 每日至少 1 次 | 每天结束前推送当日变更 |
| 重要功能完成 | 立即推送 | 完成重要功能后及时同步 |
| 离开工作区 | 强制推送 | 长时间离开前确保代码已推送 |
| 下班前 | 强制推送 | 每日工作结束前必须推送 |

## 提交信息规范

### 格式

```
<type>: <description>

<optional body>
```

### Type 类型

| 类型 | 说明 | 示例 |
|------|------|------|
| feat | 新功能 | feat: 添加用户认证模块 |
| fix | Bug 修复 | fix: 修复登录超时问题 |
| refactor | 代码重构 | refactor: 重构数据访问层 |
| docs | 文档更新 | docs: 更新 API 文档 |
| test | 测试相关 | test: 添加单元测试 |
| chore | 构建/工具 | chore: 更新依赖版本 |
| perf | 性能优化 | perf: 优化查询性能 |
| ci | CI/CD 配置 | ci: 添加 GitHub Actions |

### 描述规则

- 使用中文描述
- 简洁明了，不超过 50 个字符
- 句尾不加句号
- 使用祈使句

### 示例

```
feat: 添加知乎发布器模块

- 支持文章自动发布
- 支持图片上传
- 支持定时发布
```

## 审核要求

### 个人项目

由于是个人项目，暂不需要代码审核流程。

### 提交前检查

- [ ] 无敏感信息泄露（API 密钥、密码等）
- [ ] 无调试代码残留
- [ ] 提交信息符合规范
- [ ] 已通过本地测试

## 敏感信息处理

### 禁止提交

以下内容禁止提交到版本控制：

- `.env` 文件（包含真实 API 密钥）
- 密码、令牌、密钥
- 个人隐私信息
- 大型二进制文件

### 允许提交

- `.env.example` - 环境变量模板
- 脱敏的配置文件
- 公开的 API 端点信息

### 排除规则

使用 `.gitignore` 排除不需要跟踪的文件：

```
# Secrets
.env
.env.*
*.pem
*.key
```

## 工作流程

### 日常开发流程

1. 每日开始工作前：`git pull` 拉取最新代码
2. 开发过程中：频繁 `git add` 和 `git commit`
3. 每日结束前：`git push` 推送到远程

### 提交命令参考

```bash
# 查看当前状态
git status

# 查看变更详情
git diff

# 暂存文件
git add <file>

# 提交变更
git commit -m "type: description"

# 拉取最新代码
git pull

# 推送到远程
git push
```

## 回滚策略

### 提交回滚

```bash
# 回滚最近一次提交（保留变更）
git reset --soft HEAD~1

# 回滚最近一次提交（丢弃变更）
git reset --hard HEAD~1
```

### 恢复误删提交

```bash
# 查看 reflog
git reflog

# 恢复到指定提交
git checkout <commit-hash>
```

## 附录

### 分支策略

- **主分支**: `master` - 稳定版本
- **开发分支**: `develop` - 开发中的代码（可选）

### 标签策略

使用版本标签标记重要节点：

```bash
# 创建版本标签
git tag -a v1.0.0 -m "版本 1.0.0"

# 推送标签
git push origin v1.0.0
```
