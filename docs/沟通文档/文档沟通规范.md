# 文档沟通规范

## 核心原则

**一切运营沟通必须通过 MD 文档，留下痕迹供用户查看。**

---

## 目录结构

```
docs/沟通文档/
├── 文档沟通规范.md          # 本文件
├── 任务分配.md              # CEO 分配给各角色的任务
├── 汇报总结.md              # 各角色向 CEO 的汇报
├── 协调记录.md              # 跨角色协调记录
├── CEO-用户沟通.md          # CEO 与用户的对话记录
├── 角色记忆更新.md          # 各角色更新自己 memory 的记录
├── 100项任务清单.md        # CEO 任务来源池（100项任务）
└── 工作日志/
    └── YYYY-MM-DD.md          # 每日工作日志
```

---

## 文档类型说明

### 0. 100项任务清单.md

**用途**：用户提供的任务记录池，CEO 负责维护和执行

**关键区别**：是任务池，不是任务执行记录

**格式**：
```markdown
# 今日执行建议

## P0 任务（执行前必须确认）
- [ ] P0-XX: {任务描述}

## P1 任务（执行前必须确认）
- [ ] P1-XX: {任务描述}

## P2/P3 任务（可自主执行）
- [ ] P2/P3-XX: {任务描述}
```

---

### 1. 任务分配.md

**用途**：分配给各角色的任务记录

**任务版本号规范**：

| 层级 | 格式 | 说明 | 示例 |
|------|------|------|------|
| 主版本 | `v2` | 当前版本标识 | 当前是 v2 |
| 一级分类 | `v2.1` | 阶段或功能模块 | v2.1 创建自定义 Agents |
| 二级分类 | `v2.1.1` | 具体任务组 | v2.1.1 创建 task-agent |
| 执行任务 | 无前缀 | 具体动作项 | 创建 SKILL.md |

**版本号结构**：
```
v2.x.y
│ │ │
│ │ └─── 二级分类（子任务组）
│ └───── 一级分类（阶段/模块）
└─────── 主版本
```

**Todo List 格式**：
```markdown
## v2.1 - 一级分类标题

### v2.1.1 - 二级分类标题
- [ ] 执行任务1
- [ ] 执行任务2
- [x] 已完成任务
```

---

**任务分配格式**：

```markdown
# 任务分配

## 2026-02-24

### v2.1.1 - 任务名称

**分配给**: ceo-coach

- [ ] 执行任务1
- [ ] 执行任务2
- [ ] 检查任务执行情况
- [ ] 更新任务状态（`[ ]` → `[x]`）
- [ ] 提交代码到远程仓库

**执行状态**: ✅ 已完成
**备注**: （可选）

---

### v2.1.2 - 另一个任务

**分配给**: task-manager

- [ ] 创建任务实体
- [ ] 设置任务状态
- [ ] 记录任务优先级
- [ ] 检查任务执行情况
- [ ] 更新任务状态
- [ ] 提交代码到远程仓库

**执行状态**: 🚧 进行中
```

**状态标记**：

| 状态 | 符号 | 说明 |
|------|------|------|
| 待执行 | `[ ]` | 任务已分配，等待执行 |
| 进行中 | `[🚧]` | 正在执行中 |
| 已完成 | `[x]` | 任务已完成 |
| 部分完成 | ⚠️ | 部分目标达成，有遗留问题 |
| 暂停 | ⏸️ | 临时暂停，等待条件恢复 |
| 阻塞 | `[🚫]` | 被外部因素阻塞 |

**关键原则**：
1. **版本号层级三级**：v2.x.y
2. **标题格式统一**：`### v2.X.Y - 任务名称`
3. **任务用 Todo List**：`- [ ]` / `- [x]` 格式，不放在描述里
4. **标题使用中文**：符合项目文档规范
5. **任务完成后必须**：
   - 检查任务执行情况
   - 更新任务状态（`[ ]` → `[x]`）
   - 提交代码到远程仓库


### 2. 汇报总结.md

**用途**：各角色完成任务后向 CEO 汇报

**格式**：

```markdown
# 汇报总结

## 2026-02-24

### task-manager 汇报

**汇报时间**: 2026-02-24 15:00
**任务 ID**: TASK-2026-02-24-001
**状态**: ✅ 已完成

**执行内容**:
1. 创建了任务实体 TASK-2026-02-24-003
2. 设置了任务状态为 pending
3. 记录了任务优先级为高

**结果数据**:
\`\`\`json
{
  "taskId": "TASK-2026-02-24-003",
  "status": "pending",
  "priority": "high"
}
\`\`\`

**遇到的问题**: 无
**建议**: 无
```

### 3. 协调记录.md

**用途**：记录跨角色协调过程

**格式**：

```markdown
# 协调记录

## 2026-02-24

### 协调事件 #001

**协调时间**: 2026-02-24 16:00
**协调类型**: 顺序协调
**涉及角色**: task-manager → file-manager → knowledge-manager

**协调原因**:
需要完成一个多步骤任务：创建任务 -> 整理文件 -> 记录知识

**协调流程**:
1. CEO 分配任务给 task-manager
2. task-manager 完成后汇报
3. CEO 验收通过
4. CEO 分配任务给 file-manager
5. file-manager 完成后汇报
6. CEO 验收通过
7. CEO 分配任务给 knowledge-manager
8. knowledge-manager 完成后汇报
9. CEO 验收通过
10. CEO 生成最终汇总报告

**协调结果**: ✅ 成功
**耗时**: 约 45 分钟
**经验总结**: 顺序协调可以确保数据一致性
```

### 4. CEO-用户沟通.md

**用途**：记录 CEO 与用户的所有对话

**格式**：

```markdown
# CEO-用户沟通

## 2026-02-24

### 对话记录 #001

**时间**: 2026-02-24 13:30
**用户输入**: "帮我创建一个新任务"
**CEO 响应**:

我识别到这是一个任务创建请求，正在处理...

**执行结果**:
- ✅ 任务已创建 (TASK-2026-02-24-001)
- 状态: pending

**用户反馈**: 无
```

### 5. 角色记忆更新.md

**用途**：记录各角色更新自己 memory 的操作

**格式**：

```markdown
# 角色记忆更新

## 2026-02-24

### task-manager 更新

**更新时间**: 2026-02-24 15:00
**更新类型**: 实体创建

**更新内容**:
- 创建 Task 实体: TASK-2026-02-24-003
- 创建关系: Task -belongsTo-> User

**目的**: 记录任务创建，方便后续查询和统计
**影响范围**: 仅影响 task-manager 的 memory
```

### 6. 工作日志/日期.md

**用途**：每日工作日志，记录所有活动和决策

**格式**：

```markdown
# 工作日志 - 2026-02-24

## 今日概览

- 处理对话: 3 次
- 分配任务: 5 个
- 完成任务: 4 个
- 协调事件: 2 次

## 详细记录

### 09:00 - 会话开始
用户唤醒 CEO，CEO 以"我是 CEO"响应

### 09:30 - 任务分配
分配 TASK-2026-02-24-001 给 task-manager

## 决策记录

| 时间 | 决策 | 原因 |
|------|------|------|
| 10:00 | 验收 task-manager 的结果 | 确保质量 |
| 14:00 | 创建文档沟通规范 | 响应用户差评 |

## 明日计划

- [ ] 完成 CEO 任务来源规范
- [ ] 测试文档沟通流程
- [ ] 优化协调效率
```

---

## 沟通流程

### 用户确认机制（重要）

**所有 P1 及以上任务执行前，必须等待用户确认**

```
用户 ──▶ CEO: 建议执行 [任务]
         │
         │ 用户确认？
         ▼
    ┌─────────┐
    │   YES   │ ──▶ 创建任务分配记录 ──▶ 分配给角色 ──▶ 等待汇报
    │   NO    │ ──▶ 记录到下次讨论
    └─────────┘
```

**新增于 2026-02-24**：
1. **100项任务清单.md** - 维护100项任务池
2. **CEO 双重职责** - 沟通记录，确认后执行

### 自主规划机制

**当用户不在时（2小时无交互），CEO 可以自主规划并执行一个 P2 或 P3 任务**

- 触发条件：2小时无用户交互
- 任务选择：从 [100项任务清单](100项任务清单.md) 中选择一项
- 执行方式：不等待确认，直接执行
- 记录要求：完成后更新工作日志

### 任务重新规划机制

**执行过程中，可以对任务进行重新规划**

- 发现问题时：调整任务内容
- 发现阻塞时：调整任务依赖
- 发现优先级变化：调整优先级
- 所有变更必须：记录到任务分配.md

---

### 任务分配流程

```
用户 → CEO
    │
    ├─→ 1. 分析用户意图
    ├─→ 2. 确定负责人角色
    ├─→ 3. 创建任务记录 (任务分配.md)
    ├─→ 4. 通过 Task 工具调用角色
    ├─→ 5. 等待角色执行
    ├─→ 6. 接收角色汇报 (汇报总结.md)
    └─→ 7. 验收结果 → 更新任务状态
```

### 跨角色协调流程

```
CEO
    │
    ├─→ 1. 识别协调类型 (顺序/并行)
    ├─→ 2. 创建协调记录 (协调记录.md)
    ├─→ 3. 分配任务给各角色
    ├─→ 4. 收集各角色汇报
    ├─→ 5. 汇总结果
    └─→ 6. 更新协调记录
```

---

## 命名规范

### 文件命名

| 文件类型 | 命名规则 | 示例 |
|----------|----------|------|
| 沟通文档 | 中文命名 | 任务分配.md、汇报总结.md |
| 工作日志 | 日期.md | 2026-02-24.md |

### 实体 ID 命名

| 类型 | 格式 | 示例 |
|------|------|------|
| 任务 | TASK-YYYY-MM-DD-NNN | TASK-2026-02-24-001 |
| 协调事件 | COORD-YYYY-MM-DD-NNN | COORD-2026-02-24-001 |
| 对话记录 | CONV-YYYY-MM-DD-NNN | CONV-2026-02-24-001 |

---

## 验收标准

每次完成沟通后，必须检查：

- [ ] 文档已更新到正确位置
- [ ] 文档格式符合规范
- [ ] 记录内容完整准确
- [ ] 时间戳记录正确
- [ ] 用户可以查看所有痕迹
