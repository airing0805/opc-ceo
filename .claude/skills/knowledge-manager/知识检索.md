# 知识检索

## 功能概述

提供知识检索功能，包括语义搜索、关联查询、知识路径追踪。

## 操作命令

### 命令 1：语义搜索

**用途**：根据语义关键词搜索知识

**语法**：
```
语义搜索:
  - query: <搜索关键词>
  - entityType: <实体类型> (可选)
  - limit: <结果数量> (可选，默认10)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| query | string | 是 | 搜索关键词 |
| entityType | string | 否 | 限制实体类型：Note/Concept/Project等 |
| limit | number | 否 | 返回结果数量，默认10 |

**示例**：
```
语义搜索:
  - query: "任务管理设计"
  - entityType: Concept
  - limit: 5
```

---

### 命令 2：关联查询

**用途**：查询与指定实体相关的其他知识

**语法**：
```
关联查询:
  - entityName: <实体名称>
  - relationType: <关系类型> (可选)
  - direction: <查询方向> (可选，默认outgoing)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| entityName | string | 是 | 实体名称 |
| relationType | string | 否 | 关系类型：relates_to/used_in等 |
| direction | string | 否 | 查询方向：outgoing/incoming/all |

**示例**：
```
关联查询:
  - entityName: CONCEPT-单例模式
  - relationType: used_in
  - direction: outgoing
```

---

### 命令 3：知识路径

**用途**：追踪知识的来源和衍生关系

**语法**：
```
知识路径:
  - startEntity: <起始实体>
  - direction: <方向> (可选，默认outgoing)
  - depth: <深度> (可选，默认3)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| startEntity | string | 是 | 起始实体名称 |
| direction | string | 否 | 方向：outgoing/incoming |
| depth | number | 否 | 路径深度，默认3 |

**示例**：
```
知识路径:
  - startEntity: NOTE-2026-02-23-001
  - direction: outgoing
  - depth: 2
```

---

### 命令 4：按标签检索

**用途**：根据标签搜索知识

**语法**：
```
按标签检索:
  - tag: <标签名称>
  - entityType: <实体类型> (可选)
```

**参数**：

| 参数 | 类型 | 必需 | 说明 |
|------|------|------|------|
| tag | string | 是 | 标签名称 |
| entityType | string | 否 | 实体类型过滤 |

**示例**：
```
按标签检索:
  - tag: 设计模式
  - entityType: Concept
```

---

## MCP Memory 使用

### 语义搜索

```
使用 mcp__memory__search_nodes:
{
  "query": "任务管理设计"
}
```

### 关联查询

```
使用 mcp__memory__open_nodes 打开实体：
{
  "names": ["CONCEPT-单例模式"]
}

返回的实体包含关系信息
```

### 关系查询

```
通过 open_nodes 返回的关系信息进行筛选
```

---

## 搜索结果格式

```markdown
## 搜索结果：任务管理设计

找到 5 个相关知识：

### 相关概念
1. **[CONCEPT-单例模式](...)**
   - 描述：确保一个类只有一个实例...
   - 关联：used_in PROJ-001, relates_to CONCEPT-工厂模式

2. **[CONCEPT-工厂模式](...)**
   ...

### 相关笔记
1. **[NOTE-2026-02-23-001](...)**
   - 内容：任务管理系统的设计思路...
   - 标签：设计,任务
```

---

## 关系类型

| 关系类型 | 方向 | 说明 |
|---------|------|------|
| `relates_to` | 双向 | 概念之间的关联 |
| `used_in` | out | 概念/资源在项目中使用 |
| `learned_from` | out | 从资源学习 |
| `created_by` | out | 由人物创建 |
| `has_note` | out | 项目包含笔记 |
| `has_resource` | out | 项目使用资源 |

---

## 相关模块

- [知识存储](知识存储.md) - 知识实体存储
- [知识图谱](知识图谱.md) - 实体类型定义
- [笔记规范](笔记规范.md) - 笔记格式、模板
