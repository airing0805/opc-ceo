# 角色详细设计

## 1. CEO 核心控制 (opc-ceo-core)

### 角色定位

一人公司的总控中心，负责决策、协调和统一入口

### 能力要求

- 理解用户意图，分发到对应子角色
- 汇总各角色信息，生成综合报告
- 跨角色协调，处理复杂多步骤任务
- 维护全局上下文和状态

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 角色定义与协调逻辑 |
| `决策支持.md` | 决策支持 - 优先级判断、资源分配 |
| `上下文管理.md` | 上下文管理 - 会话状态、历史记录 |
| `协调流程.md` | 协调流程 - 多角色协作模式 |

### 核心职责

1. **意图理解**：解析用户请求，识别需要的角色
2. **任务分发**：将复杂任务拆解并分配给合适的角色
3. **结果汇总**：收集各角色的执行结果，生成统一报告
4. **上下文维护**：保持会话连续性，记住历史交互

---

## 2. 任务管理专家 (task-manager)

### 角色定位

任务和项目的全生命周期管理

### 能力要求

- 任务 CRUD 操作（创建、读取、更新、删除）
- 任务状态跟踪（TODO → IN_PROGRESS → COMPLETED）
- 任务分类（项目、标签、优先级）
- 任务搜索与过滤
- 任务统计分析（完成率、时间追踪）

### 数据存储

使用 MCP Memory 知识图谱存储任务实体

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 任务数据模型、状态定义 |
| `任务操作.md` | 使用 MCP Memory 实现任务增删改查 |
| `任务流转.md` | 状态转换（TODO→IN_PROGRESS→COMPLETED） |
| `任务统计.md` | 统计报告（日报、周报、完成率） |
| `任务模板.md` | 任务模板（每日检查、项目启动） |

### 任务状态流转

```
        ┌──────────────────────────────────────┐
        │                                      │
        ▼                                      │
    ┌───────┐    开始    ┌─────────────┐       │
    │ TODO  │ ─────────► │ IN_PROGRESS │ ──────┤
    └───────┘            └──────┬──────┘       │
        │                       │              │
        │ 阻塞                  │ 完成         │ 取消
        ▼                       ▼              ▼
    ┌─────────┐            ┌───────────┐  ┌───────────┐
    │ BLOCKED │            │ COMPLETED │  │ CANCELLED │
    └────┬────┘            └───────────┘  └───────────┘
         │                      ▲
         │ 解除阻塞              │
         └──────────────────────┘
```

---

## 3. 文件管理专家 (file-manager)

### 角色定位

本地文件系统的智能管理

### 能力要求

- 文件搜索（名称、内容、语义）
- 文件组织（分类、整理、归档）
- 文件操作（复制、移动、重命名、删除）
- 目录结构分析与优化
- 文件备份与同步

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 默认目录、文件类型支持 |
| `文件搜索.md` | 使用 Glob/Grep 进行文件搜索 |
| `文件操作.md` | 使用 Read/Write/Edit 进行文件操作 |
| `文件组织.md` | 文件分类规则、命名约定 |
| `文件备份.md` | 使用 Bash 调用 robocopy/xcopy |

### 默认配置

| 配置项 | 值 |
|--------|-----|
| 工作目录 | `E:\workspaces_2026_python\OPC-CEO` |
| 文档目录 | `E:\Documents` |
| 备份目录 | `E:\Backups` |

---

## 4. 知识管理专家 (knowledge-manager)

### 角色定位

个人知识库的构建与维护

### 能力要求

- 知识存储（笔记、文档、网页）
- 知识检索（语义搜索、关联查询）
- 知识图谱（实体关系、概念连接）
- 知识整理（分类、标签、链接）
- 学习记录（阅读进度、知识卡片）

### 数据存储

MCP Memory 知识图谱

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 知识类型、实体关系定义 |
| `知识存储.md` | 使用 MCP Memory 存储知识实体 |
| `知识检索.md` | 语义搜索、关联查询 |
| `知识图谱.md` | 实体类型（概念/项目/资源/人） |
| `笔记规范.md` | 笔记格式规范、模板 |

### 实体类型

| 类型 | 说明 | 示例 |
|------|------|------|
| Concept | 概念/想法 | 设计模式、算法 |
| Project | 项目 | OPC-CEO、个人网站 |
| Resource | 资源 | 文章、书籍、工具 |
| Person | 人物 | 联系人、作者 |

---

## 5. 财务管理专家 (finance-manager)

### 角色定位

个人/公司财务记录与分析

### 能力要求

- 收入记录
- 支出追踪
- 分类管理（项目、类别、标签）
- 财务报告（日报、周报、月报）
- 预算管理

### 数据存储

MCP Memory 知识图谱（交易实体）

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 货币单位、分类体系 |
| `交易操作.md` | 交易记录（日期/金额/类型/分类） |
| `财务分类.md` | 收入/支出分类定义 |
| `财务报告.md` | 日报、周报、月报生成 |
| `预算跟踪.md` | 预算设置与跟踪 |

### 分类体系

**收入类型**：
- 项目收入
- 咨询服务
- 产品销售
- 其他收入

**支出类型**：
- 办公设备
- 软件订阅
- 云服务
- 学习培训
- 交通出行
- 其他支出

---

## 6. 日程管理专家 (schedule-manager)

### 角色定位

时间管理与日程安排

### 能力要求

- 日程创建（事件、约会、提醒）
- 日程查询（今日、本周、指定日期）
- 时间块管理（专注时间、会议时间）
- 提醒系统
- 时间统计（时间分配分析）

### 数据存储

MCP Memory 知识图谱（事件实体）

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 时区、事件类型 |
| `事件操作.md` | 事件管理（时间/时长/提醒） |
| `每日规划.md` | 每日规划流程 |
| `时间块.md` | 时间块划分策略 |
| `时间分析.md` | 时间分配统计 |

### 时间块类型

| 类型 | 说明 | 建议时长 |
|------|------|----------|
| Deep Work | 深度工作 | 2-4 小时 |
| Meetings | 会议沟通 | 1-2 小时 |
| Admin | 行政事务 | 0.5-1 小时 |
| Learning | 学习成长 | 1-2 小时 |
| Breaks | 休息放松 | 0.5 小时 |

---

## 7. 自动化专家 (automation-manager)

### 角色定位

工作流自动化与定时任务

### 能力要求

- 定时任务定义（Cron 表达式）
- 工作流设计（顺序、并行、条件）
- 触发器配置（时间、事件）
- 任务执行（调用其他技能）
- 执行日志

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - 与 scheduler skill 集成 |
| `工作流定义.md` | 工作流定义格式 |
| `触发器.md` | 触发器配置（定时/事件） |
| `执行器.md` | 执行逻辑、错误重试 |

### 工作流定义

```yaml
workflow:
  id: daily-review
  name: 每日回顾
  trigger:
    type: cron
    schedule: "0 18 * * *"  # 每天 18:00
  steps:
    - name: 收集完成的任务
      skill: task-manager
      action: get-completed-today
    - name: 生成日报
      skill: task-manager
      action: generate-daily-report
    - name: 保存报告
      skill: file-manager
      action: save-file
```

---

## 8. Claude SDK 执行器 (claude-sdk-executor)

### 角色定位

通过 Claude API/SDK 进行程序化调用的执行层

### 能力要求

- Claude API 调用（Messages API、Tools）
- 批量处理任务
- 自动化工作流执行
- 其他 skills 的程序化调用
- 结果解析与存储

### 技术栈

- Anthropic Python SDK (`anthropic`)
- 或通过 Bash 调用 `claude` CLI

### 技能文件

| 文件 | 职责 |
|------|------|
| `SKILL.md` | 主入口 - SDK 配置、认证、调用模式 |
| `API调用.md` | Messages API 调用模式、工具使用 |
| `批量处理.md` | 批量任务处理、并发控制 |
| `技能调用.md` | 程序化调用其他 skills |
| `结果处理.md` | 结果解析、存储、错误处理 |

### 调用模式

**模式 1：Bash 调用 Claude CLI**
```bash
# 单次对话
claude -p "你的提示"

# 带文件上下文
claude -p "分析这个文件" -f input.txt

# 使用特定模型
claude -p "任务" --model claude-sonnet-4-20250514
```

**模式 2：通过 MCP 工具**
- 使用现有的 Task 工具启动 agent
- 调用 Skill 工具执行技能

### 架构图

```
┌─────────────────────────────────────────────────────────┐
│              claude-sdk-executor                        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────────┐    ┌─────────────┐    ┌────────────┐  │
│  │ API Calls   │    │ Batch       │    │ Skill      │  │
│  │ Messages    │    │ Processing  │    │ Invocation │  │
│  │ Tools       │    │ Concurrent  │    │ Programmatic│ │
│  └──────┬──────┘    └──────┬──────┘    └─────┬──────┘  │
│         │                  │                  │         │
│         └──────────────────┼──────────────────┘         │
│                            │                            │
│                   ┌────────▼────────┐                   │
│                   │ Result Handler  │                   │
│                   │ Parse/Store     │                   │
│                   └─────────────────┘                   │
│                                                         │
└─────────────────────────────────────────────────────────┘
```
