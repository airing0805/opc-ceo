# 任务配置

## 配置项

| 配置项 | 类型 | 说明 | 默认值 |
|--------|------|------|--------|
| taskName | string | Windows 任务名称 | - |
| title | string | 任务标题 | taskName |
| description | string | 任务描述 | - |
| schedule | string | 调度规则（自然语言或 cron） | - |
| prompt | string | Claude 执行的提示词 | - |
| workingDirectory | string | 工作目录 | 当前项目 |
| skipPermissions | boolean | 是否跳过权限检查 | false |
| logFile | string | 日志文件路径 | .claude/logs/{taskName}.log |

## 修改任务

### 修改调度

```powershell
# 禁用任务
Disable-ScheduledTask -TaskName <TaskName>

# 启用任务
Enable-ScheduledTask -TaskName <TaskName>

# 修改触发器（需要重新注册）
Unregister-ScheduledTask -TaskName <TaskName> -Confirm:$false
# 然后重新注册新配置
```

### 修改执行脚本

直接编辑 `.claude/schedules/<taskName>.bat` 文件，无需重新注册任务。

## 配置示例

### 每20分钟执行

```powershell
$trigger = New-ScheduledTaskTrigger -Once -At (Get-Date) -RepetitionInterval (New-TimeSpan -Minutes 20)
```

### 每天早上9点执行

```powershell
$trigger = New-ScheduledTaskTrigger -Daily -At 9:00
```

### 工作日执行

```powershell
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday,Tuesday,Wednesday,Thursday,Friday -At 9:00
```

## 任务设置

| 设置 | 说明 |
|------|------|
| StartWhenAvailable | 如果错过了计划时间，启动时立即运行 |
| DontStopOnIdleEnd | 计算机不进入空闲状态时停止任务 |
| AllowStartIfOnBatteries | 允许在电池供电时运行 |
| DontStopIfGoingOnBatteries | 切换到电池供电时不停止任务 |

```powershell
$settings = New-ScheduledTaskSettingsSet -StartWhenAvailable -DontStopOnIdleEnd -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries
```
