# 第一章：MCP 概述与入门

> 本章将带你了解 MCP（Model Context Protocol）是什么，为什么需要它，以及如何开始使用它。读完本章，你将对 MCP 有一个清晰的认识，并做好实践准备。

---

## 1.1 什么是 MCP

MCP（Model Context Protocol，模型上下文协议）是 Anthropic 在 2024 年底推出的一种开放标准，旨在解决 AI 助手与外部数据源、工具之间的连接问题。

简单来说，MCP 就像是 AI 助手的"万能转接头"。

想象一下这个场景：你正在使用 Claude 帮你工作，你希望它能：
- 读取你本地电脑上的文件
- 查询你公司数据库里的数据
- 调用你常用的 API 服务
- 操作你的开发工具

在 MCP 出现之前，每接入一个数据源或工具，都需要单独开发集成方案。这不仅工作量大，而且难以维护。

MCP 的出现改变了这一切。它提供了一套统一的标准，让任何 AI 应用都能通过相同的协议连接到各种数据源和工具。就像 USB 接口统一了各种外设的连接方式一样，MCP 统一了 AI 与外部世界的连接方式。

### MCP 的官方定义

根据 Anthropic 的官方说明，MCP 是：

> 一个开放标准，使开发者能够在其数据源和 AI 驱动的工具之间建立安全的双向连接。

这个定义中有几个关键词值得注意：
- **开放标准**：任何人都可以使用和扩展
- **安全**：内置权限控制和数据保护
- **双向连接**：既能读取数据，也能执行操作

---

## 1.2 MCP 的核心概念

要理解 MCP，需要掌握几个核心概念：服务器（Server）、客户端（Client）、工具（Tool）和资源（Resource）。

### 1.2.1 服务器（Server）

MCP 服务器是提供功能的"服务端"。它暴露特定的能力，等待客户端来调用。

可以把 MCP 服务器理解为一个"能力提供者"。比如：
- **文件系统服务器**：提供读写文件的能力
- **数据库服务器**：提供查询数据库的能力
- **GitHub 服务器**：提供操作 GitHub 仓库的能力

每个服务器都是独立的，专注于某一类功能。这种设计让服务器可以独立开发、部署和维护。

### 1.2.2 客户端（Client）

MCP 客户端是使用功能的"消费端"。它连接到服务器，调用服务器提供的工具和资源。

在大多数场景下，AI 应用（如 Claude Desktop、Cursor、Windsurf）就是 MCP 客户端。它们通过 MCP 协议连接到各种服务器，获取数据或执行操作。

### 1.2.3 工具（Tool）

工具是服务器暴露的可执行功能。每个工具都有：
- **名称**：唯一标识符
- **描述**：说明工具的用途
- **输入参数**：定义工具需要什么参数
- **输出结果**：执行后返回的数据

例如，一个文件系统服务器可能提供以下工具：
- `read_file`：读取文件内容
- `write_file`：写入文件内容
- `list_directory`：列出目录内容
- `search_files`：搜索文件

当 AI 需要读取文件时，它会调用 `read_file` 工具，传入文件路径作为参数。

### 1.2.4 资源（Resource）

资源是服务器暴露的可读数据。与工具不同，资源是"静态"的数据端点，类似于文件或 API 端点。

资源通过 URI（统一资源标识符）来标识，例如：
- `file:///path/to/document.txt`
- `github://repo/issue/123`

AI 可以通过资源 URI 直接访问数据，而不需要执行任何操作。

### 1.2.5 提示词（Prompt）

提示词是服务器提供的预定义模板。它们可以帮助用户快速执行常见任务。

例如，一个代码分析服务器可能提供以下提示词：
- "分析这段代码的性能瓶颈"
- "为这个函数生成单元测试"
- "重构这段代码以提高可读性"

### 概念关系图

```
┌─────────────────────────────────────────────────────────┐
│                    MCP 客户端（AI 应用）                   │
│                                                         │
│   例如：Claude Desktop、Cursor、Windsurf                  │
└─────────────────────┬───────────────────────────────────┘
                      │
                      │ MCP 协议
                      │
        ┌─────────────┼─────────────┐
        │             │             │
        ▼             ▼             ▼
┌───────────┐ ┌───────────┐ ┌───────────┐
│ 文件系统   │ │  GitHub   │ │  数据库    │
│  服务器    │ │   服务器   │ │   服务器   │
├───────────┤ ├───────────┤ ├───────────┤
│ 工具：     │ │ 工具：     │ │ 工具：     │
│ - 读写文件 │ │ - 创建 PR  │ │ - 执行查询 │
│ - 搜索文件 │ │ - 查看 Issue│ │ - 插入数据 │
│           │ │           │ │           │
│ 资源：     │ │ 资源：     │ │ 资源：     │
│ - 文件内容 │ │ - 代码仓库 │ │ - 表结构   │
└───────────┘ └───────────┘ └───────────┘
```

---

## 1.3 MCP 与 Claude 的关系

MCP 是 Anthropic 推出的协议，与 Claude 有着天然的紧密联系。

### Claude Desktop：最早的 MCP 客户端

Claude Desktop 是最早支持 MCP 的应用。在 Claude Desktop 中，你可以配置多个 MCP 服务器，让 Claude 能够：
- 读取和写入本地文件
- 搜索网页内容
- 连接数据库
- 操作 GitHub 仓库
- ...以及更多

### 配置示例

Claude Desktop 的 MCP 配置文件位于：
- **macOS**：`~/Library/Application Support/Claude/claude_desktop_config.json`
- **Windows**：`%APPDATA%/Claude/claude_desktop_config.json`

一个简单的配置示例：

```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/Users/yourname/Documents"
      ]
    },
    "github": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-github"],
      "env": {
        "GITHUB_TOKEN": "your-github-token"
      }
    }
  }
}
```

配置完成后，重启 Claude Desktop，Claude 就能访问你指定的文件夹和 GitHub 仓库了。

### Claude Code：开发者专属的 MCP 体验

Claude Code 是 Anthropic 推出的命令行 AI 编程助手，同样支持 MCP。它让开发者可以在终端中使用 MCP 的强大功能。

在 Claude Code 中，你可以：
- 让 AI 直接操作你的代码库
- 执行数据库迁移
- 与 CI/CD 系统交互
- 自动化开发流程

---

## 1.4 为什么需要 MCP

在 MCP 出现之前，AI 助手面临着严重的"数据孤岛"问题。

### 问题一：每次集成都是定制开发

假设你想让 Claude 访问你的：
- 本地文件系统
- PostgreSQL 数据库
- Jira 项目管理
- Slack 消息

你需要为每个数据源开发专门的集成，这是巨大的工作量。而且，如果你想换一个 AI 助手（比如从 Claude 换到 GPT），所有集成都要重做。

### 问题二：安全问题

让 AI 访问敏感数据需要谨慎的权限控制。但传统的集成方式往往缺乏统一的安全模型，容易出现：
- 权限过度授予
- 数据泄露风险
- 审计困难

### 问题三：开发者的选择困境

作为工具开发者，你不知道该为哪个 AI 平台开发集成。支持 Claude？支持 OpenAI？还是两者都要？这导致很多有价值的工具没有 AI 集成。

### MCP 如何解决这些问题

| 问题 | MCP 的解决方案 |
|------|---------------|
| 定制开发 | 统一协议，一次开发，处处可用 |
| 安全问题 | 内置权限模型，支持范围限制 |
| 选择困境 | 开放标准，所有 AI 平台都能用 |

**MCP 的核心价值**：
1. **标准化**：用同一套协议连接所有数据源
2. **可复用**：一次开发的服务器可以被多个客户端使用
3. **安全性**：内置权限控制和数据保护机制
4. **开放性**：任何人都可以实现 MCP 服务器或客户端

---

## 1.5 MCP 生态系统现状

自 MCP 发布以来，生态系统发展迅速。

### 官方服务器

Anthropic 提供了一系列官方 MCP 服务器：

| 服务器 | 功能 |
|--------|------|
| `server-filesystem` | 文件系统操作 |
| `server-github` | GitHub 仓库管理 |
| `server-postgres` | PostgreSQL 数据库 |
| `server-sqlite` | SQLite 数据库 |
| `server-puppeteer` | 网页浏览和截图 |
| `server-google-maps` | Google Maps API |
| `server-slack` | Slack 集成 |

### 社区服务器

社区也在积极贡献各种 MCP 服务器，覆盖：
- 云服务（AWS、Azure、GCP）
- 数据库（MySQL、MongoDB、Redis）
- 开发工具（Git、Docker、Kubernetes）
- 生产力工具（Notion、Linear、Jira）
- 等等...

### 支持的客户端

目前支持 MCP 的客户端包括：
- **Claude Desktop**：官方桌面应用
- **Claude Code**：命令行编程助手
- **Cursor**：AI 编程 IDE
- **Windsurf**：AI 编程 IDE
- **Continue**：开源 AI 编程助手
- **Zed**：高性能编辑器

---

## 1.6 环境准备要求

在开始使用 MCP 之前，你需要准备以下环境。

### 必需条件

1. **Node.js（v18 或更高版本）**

   MCP 服务器大多使用 TypeScript/JavaScript 开发，需要 Node.js 运行环境。

   检查是否已安装：
   ```bash
   node --version
   ```

   如果未安装，请访问 [nodejs.org](https://nodejs.org) 下载安装。

2. **npm 或 pnpm**

   Node.js 自带 npm，也可以选择更快的 pnpm：
   ```bash
   npm install -g pnpm
   ```

3. **一个 MCP 客户端**

   选择以下之一：
   - Claude Desktop（推荐新手）
   - Claude Code（推荐开发者）
   - Cursor 或 Windsurf（推荐编程场景）

### 可选条件

根据你的使用场景，可能还需要：

1. **Python（v3.10 或更高版本）**

   如果你需要使用 Python 编写的 MCP 服务器或开发自己的服务器。

2. **Docker**

   某些 MCP 服务器可能通过 Docker 部署。

3. **各类 API Token**

   - GitHub Personal Access Token
   - Slack Bot Token
   - 数据库连接信息
   - 等等...

### 验证环境

安装完成后，运行以下命令验证：

```bash
# 检查 Node.js
node --version  # 应该显示 v18.x.x 或更高

# 检查 npm
npm --version

# 检查 Python（如果安装了）
python --version  # 应该显示 3.10.x 或更高
```

---

## 1.7 本章小结

本章我们学习了：

1. **MCP 是什么**：一种让 AI 助手连接外部数据源和工具的开放标准
2. **核心概念**：服务器、客户端、工具、资源、提示词
3. **MCP 与 Claude**：Claude Desktop 和 Claude Code 都支持 MCP
4. **为什么需要 MCP**：解决定制开发、安全问题、选择困境
5. **生态系统现状**：官方和社区提供了丰富的服务器
6. **环境准备**：Node.js、npm、MCP 客户端

下一章，我们将动手配置第一个 MCP 服务器，体验 MCP 的强大功能。

---

## 延伸阅读

- [MCP 官方文档](https://modelcontextprotocol.io/)
- [Anthropic MCP 介绍](https://www.anthropic.com/news/model-context-protocol)
- [MCP GitHub 仓库](https://github.com/modelcontextprotocol)
