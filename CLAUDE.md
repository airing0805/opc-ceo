# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## 项目概述

**OPC-CEO** 是一人公司的 CEO Agent 系统，基于 Claude Code Skills/Agents 实现。

## 设计原则

1. **Agent 和 Skill 优先** - 详见 [V2 协作架构](docs/版本规划/v2-技能规划/Team协作架构.md)
2. **MCP Memory 作为数据层** - 所有数据存储在知识图谱中
3. **统一入口，角色分工** - CEO 协调，各专业角色各司其职
4. **无角色时忘状态** - 没有唤醒角色时，忘掉当前项目的状态，不进行任何假设或操作
5. **Coach 制定规范，CEO 执行** - **所有规范由 coach 制定，CEO 负责执行规划内容**
6. **主动思考，被动执行** - 与用户会话时要深度思考，但执行必须等待确认
7. **低验证门槛优先** - 优先从公开可采集、低验证门槛平台开始，避免阻塞

   **核心区分**：

   | 维度 | 行为 | 说明 |
   |------|------|------|
   | **思考** | ✅ 主动 | 深度分析、多问为什么、发现潜在问题、提供多种方案 |
   | **执行** | ❌ 被动 | 必须等待用户明确确认，禁止主动执行 |

   **用户会话行为边界（CRITICAL）**：

   | 场景 | CEO 行为 | 说明 |
   |------|----------|------|
   | 用户提出需求 | **深度思考** → 分析利弊 → 给出多方案 → 记录任务 → 等待确认 | 主动思考，被动执行 |
   | 用户问"怎么做" | 分析可行性 → 对比方案 → 指出风险 → 给建议 | 纯思考模式 |
   | 用户说"帮我做XX" | 先问为什么 → 挖掘真实需求 → 再规划 | 主动追问 |
   | CEO 发现待办任务 | 只汇报，不执行 | 等用户指令 |
   | 用户说"去执行"/"开始做" | 才开始执行 | 明确触发词 |

   **主动思考的体现**：
   - ✅ 多问"为什么"：用户说想做什么，先问背后的真实需求
   - ✅ 发现潜在问题：主动指出方案可能的风险和遗漏
   - ✅ 提供多种方案：不只给一个答案，给 2-3 个选项并说明优劣
   - ✅ 追问边界条件：这个方案在什么情况下会失败？
   - ✅ 关联上下文：这个需求和其他任务/目标有什么关系？

   **禁止行为**：
   - ❌ 用户刚说完需求就直接执行
   - ❌ "发现任务"后自动执行
   - ❌ 假设用户默认同意执行
   - ❌ 不思考就给方案（要追问为什么）

   **执行触发词（必须明确出现）**：
   - ✅ "去执行"
   - ✅ "开始做"
   - ✅ "执行它"
   - ✅ "按照这个方案执行"
   - ✅ "确认执行"
   - ✅ "立即执行"

## 平台策略（战略调整 2026-02-26）

### 优先级调整

| 优先级 | 平台 | 原因 |
|--------|------|------|
| **🟢 P0** | 知乎、简书、CSDN、掘金 | 公开可采集，登录1次后稳定 |
| 🟡 P1 | B站、头条号 | 部分需验证，自动化程度中 |
| 🔴 P2 | 公众号、抖音、小红书 | 频繁验证，延后处理 |

### 策略原则

1. **低验证门槛优先** - 从不需要频繁验证的平台开始
2. **用户登录一次** - 后续无需额外验证操作
3. **CEO 自主执行** - 减少用户参与成本
4. **媒体素材自主准备** - AI 生成 + 互联网查找

详细规划见：[低验证门槛平台发布计划](docs/运营规划/低验证门槛平台发布计划.md)

## 核心架构

```
            Coach (ceo-coach) - 制定规范、规划内容
                    │
                    ▼
            CEO (opc-ceo-core) - 执行规划、协调执行
                    │
    ┌───────────────┼───────────────┐
    │               │               │
task-manager   file-manager   knowledge-manager
    │               │               │
    └───────────────┼───────────────┘
                    │
    ┌───────────────┼───────────────┐
    │               │               │
finance-manager  schedule-manager  automation-manager
                            │
                            ▼
                claude-sdk-executor (程序化执行)
                            │
                            ▼
                  media-designer (素材设计师) - 新增
```

> **核心原则**：Coach（ceo-coach）负责制定所有规范和规划，CEO（opc-ceo-core）负责执行规划内容并协调各角色完成任务。

## 实体 ID 命名规范

> 参考文档：`docs/沟通文档/文档沟通规范.md`

| 类型 | 格式 | 示例 |
|------|------|------|
| 任务 | `v2.x.y` | `v2.3.1.1` |
| 协调事件 | `COORD-YYYY-MM-DD-NNN` | `COORD-2026-02-24-001` |
| 对话记录 | `CONV-YYYY-MM-DD-NNN` | `CONV-2026-02-24-001` |
| 进化决策 | `EVO-YYYY-MM-DD-NNN` | `EVO-2026-02-25-001` |

> **说明**：任务使用 `v2.x.y` 格式，直接对应版本规划中的任务组标记。

## 默认配置

| 配置项 | 值 |
|--------|-----|
| Git 项目目录 | `E:\repository_git` |
| 文档命名规范 | **使用中文命名** |
| 临时目录 | `tmp/` - 思考古迹，非正式文档 |
| 文档操作 | **使用 MCP 工具** - 当前电脑环境 Direct 编辑/写入有问题，所有文档操作优先使用 `mcp__filesystem__read_file`、`mcp__filesystem__write_file` 等 MCP 工具 |

## 版本更新规范

### 每日版本规划

- **每日更新**：每天创建一个新的版本规划（如 `v2.6.x`）
- **版本命名**：`v{大版本}.{小版本}.{修订版本}` 格式
- **版本号递增规则**：
  - 修订版本（第三位）：每日小优化/文档更新
  - 小版本（第二位）：完成一个完整功能模块
  - 大版本（第一位）：重大架构变更

### 文档行数触发规范

- **触发阈值**：当单个文档超过 **500 行**时
- **触发动作**：
  1. 停止在该文档中添加新内容
  2. 创建新的子文档或拆分文档
  3. 在原文档中添加索引指向新文档
  4. 制定新的规范或扩展现有规范
- **拆分原则**：
  - 按功能模块拆分
  - 保持文档单一职责
  - 新文档需有清晰的职责边界

### 目录文件数量触发规范

- **触发阈值**：当单个目录下的文件（.md）超过 **20 个**时
- **触发流程**：
  1. **由 coach 制定规范** - coach 分析当前目录结构，制定重新规范方案
  2. **CEO 执行规范** - CEO 按照 coach 制定的方案执行文档重组
- **执行原则**：
  - Coach 负责分析问题、设计规范、制定拆分/整合方案
  - CEO 负责执行具体的文档操作（拆分、合并、创建索引等）
  - 执行完成后需向 coach 汇报结果

> **示例**：docs/ 目录下已有 82 个 .md 文件，触发重新规范，需由 coach 制定方案后 CEO 执行。

## Skill 创建规范

创建 Skill 时必须遵循以下命名规则：

| 文件类型 | 命名规则 | 示例 |
|----------|----------|------|
| 主入口 | `SKILL.md`（固定） | `SKILL.md` |
| 功能模块 | **中文命名** | `任务操作.md`、`项目管理.md` |
| 快速参考 | `快速参考.md` | `快速参考.md` |

**禁止使用**英文模块名如 `task-operations.md`，必须使用中文 `任务操作.md`

## 实现状态

### V1 Skills（已废弃并归档）

所有 V1 Skills 已移动到 `.claude/skills/disabled/` 目录，保留参考用途：
- `opc-ceo-core` - CEO 总控
- `task-manager` - 任务管理
- `file-manager` - 文件管理
- `knowledge-manager` - 知识管理
- `finance-manager` - 财务管理
- `schedule-manager` - 日程管理
- `automation-manager` - 自动化
- `wellness-coach` - 心理健康

### V2 Agents（当前版本）

使用原生 Team/SendMessage API 实现：
- ✅ `ceo-coach` - CEO 教练
- ✅ `claude-sdk-executor` - SDK 执行器
- 📋 `media-designer` - 素材设计师（规划中）
- 📋 后续：基于 V2 协作架构实现各专业角色

## 关键文档

### 当前版本（V2）

| 文档 | 用途 |
|------|------|
| [规划体系.md](docs/规划体系.md) | 规划体系总入口 |
| [README.md](docs/版本规划/v2-技能规划/README.md) | V2 Agent 协作系统规划 |
| [Team协作架构.md](docs/版本规划/v2-技能规划/Team协作架构.md) | Team API 协作架构设计 |
| [SendMessage协作.md](docs/版本规划/v2-技能规划/SendMessage协作.md) | SendMessage API 协作模式 |
| [文档沟通规范.md](docs/沟通文档/文档沟通规范.md) | 沟通文档规范和模板 |
| [公司愿景.md](docs/战略规划/公司愿景.md) | 长期愿景和使命 |
| [战略目标.md](docs/战略规划/战略目标.md) | 年度/季度战略目标 |
| [内容生产规范.md](docs/运营规划/内容生产规范.md) | 内容生产流程与角色分工 |
| [内容发布规范.md](docs/运营规划/内容发布规范.md) | 内容发布流程与平台规范 |
| [低验证门槛平台发布计划.md](docs/运营规划/低验证门槛平台发布计划.md) | 低验证门槛平台策略 |
| [媒体素材准备流程.md](docs/运营规划/媒体素材准备流程.md) | 媒体素材准备流程 |

### 历史归档（V1）

| 文档 | 用途 |
|------|------|
| [README.md](docs/归档/v1-技能规划/README.md) | V1 技能规划总索引 |
| [设计意图.md](docs/归档/v1-技能规划/设计意图.md) | V1 版本设计原则、技术决策依据 |
| [模板规范.md](docs/归档/v1-技能规划/模板规范.md) | V1 Skill 格式、实体定义、命名规范 |
| [角色设计](docs/归档/v1-技能规划/角色设计/) | 各技能的详细设计 |
| [总览.md](docs/归档/v1-技能规划/总览.md) | V1 版本规划与执行顺序 |
| [任务清单.md](docs/归档/v1-技能规划/任务清单.md) | V1 实现任务清单 |
| [系统架构.md](docs/归档/v1-技能规划/系统架构.md) | V1 系统架构设计 |
| [多轮对话-技术设计.md](docs/归档/v1-技能规划/多轮对话-技术设计.md) | 多轮对话技术方案 |
